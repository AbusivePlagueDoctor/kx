COL_coup_risk_increase = {
	if = {
		limit = {
			check_variable = {
				var = COL_army_coup_risk
				value = 4
				compare = greater_than_or_equals
			}
		}
		custom_effect_tooltip = COL_army_coup_risk_rise_tt
		country_event = {
			id = col.46
			days = 5
		}
	}
	if = {
		limit = { 
			check_variable = {
				var = COL_army_coup_risk
				value = 4
				compare = less_than
			}
		}
		custom_effect_tooltip = COL_army_coup_risk_rise_tt
		hidden_effect = {
			set_variable = {
				var = COL_army_coup_risk
				value = 1
			}
		}
	}
}

COL_coup_risk_decrease = {
	if = {
		limit = {
			check_variable = {
				var = COL_army_coup_risk
				value = 4
				compare = greater_than_or_equals
			}
		}
		custom_effect_tooltip = COL_army_coup_risk_lower_tt
		country_event = {
			id = col.46
			days = 5
		}
	}
	if = {
		limit = { 
			check_variable = {
				var = COL_army_coup_risk
				value = 4
				compare = less_than
			}
		}
		custom_effect_tooltip = COL_army_coup_risk_lower_tt
		hidden_effect = {
			subtract_from_variable = {
				var = COL_army_coup_risk
				value = 1
			}
		}
	}
}

COL_setup_for_COLCW = { #SETUP TO PLAY AS COMMUNE IN CIVIL WAR
	#COL_remove_all_generals = yes
	#COC = { COL_remove_all_generals = yes }
	#COL_add_government_generals = yes
	#COL_add_neutral_generals = yes
	COC = {
		#transfer_state = 486
		#transfer_state = 851
		add_state_core = 486 #meta
		add_state_core = 851 #caqueta
		#every_owned_state = {
			#limit = { is_core_of = COC }
			#COC = { transfer_state = PREV }
		#}
		every_state = {
			limit = {
				is_core_of = COL
				NOT = { is_core_of = COC }
				NOT = { is_claimed_by = COC }
			}
			add_claim_by = COC
		}
		set_capital = 486 # META
		every_owned_state = {
			teleport_armies = {
				limit = { tag = COL }
				to_state_array = owned_controlled_states
			}
		}
		#COL_copy_ideas = yes
		division_template = {
			name = "Division Revolucionaria Colombiana" #INF
			division_names_group = COL_INF_01
			regiments = {
				infantry = { x = 0 y = 0 }
				infantry = { x = 0 y = 1 }
				infantry = { x = 0 y = 2 }
				infantry = { x = 1 y = 0 }
				infantry = { x = 1 y = 1 }
				infantry = { x = 1 y = 2 }
			}
		}
		division_template = {
			name = "Milicia Socialista Colombiana" #MILITIA
			division_names_group = COL_INF_01
			regiments = {
				militia = { x = 0 y = 0 }
				militia = { x = 0 y = 1 }
				militia = { x = 0 y = 2 }
				militia = { x = 1 y = 0 }
				militia = { x = 1 y = 1 }
				militia = { x = 1 y = 2 }
				militia = { x = 2 y = 0 }
			}
		}
		set_variable = { strength = COL.num_divisions }
		multiply_variable = { var = strength value = 0.7 }
		clamp_variable = { var = strength max = 20 min = 4 }
		set_variable = { counter = 0 }
		COL_add_rebel_units = yes
		add_ideas = {
			extensive_conscription
		}

		country_event = { id = col.100 hours = 3 } # COLCW starts
		add_stability = 0.10 #Player's Buff
	}
	
	COL = {
		add_popularity = {
			ideology = paternal_autocrat
			popularity = 0.20
		}
		send_equipment_fraction = { target = COC value = 0.40 }
		if = { # PLAY AS REBELS/COMMUNE - UNIR
			limit = { has_global_flag = COL_communeUNIR }
			COL_commune_cano_and_generals = yes
			set_politics = {
				ruling_party = radical_socialist
				elections_allowed = no
			}
			set_cosmetic_tag = COL_playcommuneunir
		}
		if = { # PLAY AS REBELS/COMMUNE - SYNDIE
			limit = { has_global_flag = COL_communesyndicalist }
			COL_commune_cano_and_generals = yes
			set_politics = {
				ruling_party = syndicalist
				elections_allowed = no
			}
			set_cosmetic_tag = COL_playcommunesyndie
		}
		if = { # PLAY AS REBELS/COMMUNE - TOTALIST
			limit = { has_global_flag = COL_communetotalist }
			COL_commune_cano_and_generals = yes
			#COL_add_royalist_generals  = yes
			set_politics = {
				ruling_party = totalist
				elections_allowed = no
			}
			set_cosmetic_tag = COL_playcommunetot
		}
		every_owned_state = {
			teleport_armies = {
				limit = { tag = COC }
				to_state_array = owned_controlled_states
			}
		}
	}
}

COL_commune_cano_and_generals = { #for Colombian CV setup
	retire_country_leader = yes
	retire_ideology_leader = radical_socialist
	retire_ideology_leader = syndicalist
	retire_ideology_leader = totalist
	create_country_leader = {
		name = "María de los Ángeles Cano"
		desc = "POLITICS_COL_CANO_DESC"
		picture = "Portrait_Columbia_Maria_Cano.tga"
		expire = "1965.1.1"
		ideology = radical_socialist_subtype
	}
	create_country_leader = {
		name = "María de los Ángeles Cano"
		desc = "POLITICS_COL_CANO_DESC"
		picture = "Portrait_Columbia_Maria_Cano.tga"
		expire = "1965.1.1"
		ideology = syndicalist_subtype
	}
	create_country_leader = {
		name = "María de los Ángeles Cano"
		desc = "POLITICS_COL_CANO_DESC"
		picture = "Portrait_Columbia_Maria_Cano.tga"
		expire = "1965.1.1"
		ideology = totalist_subtype
	}
	add_ideas = COL_Leon_de_Greiff_hog_rso
	add_ideas = COL_Jose_Antonio_Osorio_for_rso
	add_ideas = COL_Ignacio_Torres_Giraldo_eco_rso
	add_ideas = COL_Juan_de_la_Cruz_Varela_sec_rso
	add_popularity = {
		ideology = radical_socialist
		popularity = 0.03
	}
	add_popularity = {
		ideology = syndicalist
		popularity = 0.03
	}
	add_popularity = {
		ideology = totalist
		popularity = 0.03
	}
	#event_target:SIA_Phraya_Srisitthisongkhram = { set_nationality = PREV }
	#event_target:SIA_Prince_Boworadet = { set_nationality = PREV }
	#event_target:SIA_Phrayra_Rithhi_arkaney = { set_nationality = PREV }
	#transfer_state =
	#transfer_state =
	#transfer_state =
}

COL_add_rebel_units = { #always fire
	random_owned_controlled_state = {
		create_unit = {
			division = "division_template = \"Milicia Socialista Colombiana\" start_experience_factor = 0.2"
			owner = COC
		}
	}
	subtract_from_variable = { var = strength value = 1 }
	if = {
		limit = { 
			check_variable = { strength > 0.99 } 
		}
		add_to_variable = { var = counter value = 1 }
		if = {
			limit = { 
				check_variable = { counter > 2.99 } 
			}
			COL_add_inf_rebel_units = yes
		}
		if = {
			limit = { 
				check_variable = { counter < 3 } 
			}
			COL_add_rebel_units = yes
		}
	}
}

COL_add_inf_rebel_units = { #always fire
	random_owned_controlled_state = {
		create_unit = {
			division = "division_template = \"Division Revolucionaria Colombiana\" start_experience_factor = 0.2"
			owner = COC
		}
	}
	subtract_from_variable = { var = strength value = 1 }
	if = {
		limit = { check_variable = { strength > 0.99 } }
		COL_add_rebel_units = yes
	}
}

